- content_for :head do
  = javascript_include_tag "pages/teacher/questions/index-bundle"
  = stylesheet_link_tag "pages/teacher/questions/index-bundle", :media => "all"
  :javascript
    window.type = "#{@type}"
    window.book_id = "#{@current_book.present? ? @current_book.id.to_s : ''}"
    window.root_point_id = "#{@current_root_point.present? ? @current_root_point.id.to_s : ''}"
    window.point_id = "#{@current_point.present? ? @current_point.id.to_s : ''}"

- content_for :teacher_content do
  #question-index
    #book-bar
      #type-selector
        %p
          %strong 类型选择
        = select_tag :tiku_type, options_for_select(tiku_type, 0)
      - if @type == "tongbu"
        %table
          %tr
            %th 版本选择
            %td
              %ul.edition-ul
                - @editions.each do |e|
                  - if e == @current_edition
                    %li.edition-ele.selected{data: {id: e.id.to_s}}= e.name
                  - else
                    %li.edition-ele{data: {id: e.id.to_s}}= e.name
          %tr
            %th 教材选择
            %td#books-wrapper
              %ul.book-ul
                - @books.each do |b|
                  - if b == @current_book
                    %li.book-ele.selected{data: {id: b.id.to_s}}= b.name
                  - else
                    %li.book-ele{data: {id: b.id.to_s}}= b.name
      - elsif @type == "zhuanxiang"
        %table
          %tr
            %td
              %ul.root-point-ul
                - @root_points.each do |p|
                  - if p == @current_root_point
                    %li.root-point-ele.selected{data: {id: p.id.to_s}}= p.name
                  - else
                    %li.root-point-ele{data: {id: p.id.to_s}}= p.name
    .clear-both
    #content-background
      - if @type == "tongbu"
        #left-part
          .folder-node#root-folder
            .name-node.root
              %span.caret-wrapper
                %b.open
              %i.icon.folder-open
            .children.hide
        #right-part
      - elsif @type == "zhuanxiang"
        #left-part
          .folder-node#root-folder
            .name-node.root
              %span.caret-wrapper
                %b.open
              %i.icon.folder-open
            .children.hide
        #right-part
          #right-head
            #question-paginator-wrapper
              = paginator_mini @questions
          .clear-both
          #right-questions
            - @questions["data"].each do |q|
              .content-div{data: {"question-id" => q.id.to_s, "question-type" => q.type}}
                .question-content-div
                  .question-content
                    = render :partial => "partials/question_content", locals: { content: q.content, image_path: q.image_path }
                  - if q.type == "choice"
                    .question-items{data: {"question-answer" => q.answer}}
                      - if q.item_len < 8
                        %table.line4
                          %tr
                            - q.items.each_with_index do |item, index|
                              %td
                                %label= d2c(index) + ". "
                                %span.item-content= item.render_question(q.image_path).html_safe
                      - elsif q.item_len < 16
                        %table.line2
                          %tr
                            - q.items[0..1].each_with_index do |item, index|
                              %td
                                %label= d2c(index) + ". "
                                %span.item-content= item.render_question(q.image_path).html_safe
                          %tr
                            - q.items[2..3].each_with_index do |item, index|
                              %td
                                %label= d2c(index + 2) + ". "
                                %span.item-content= item.render_question(q.image_path).html_safe
                      - else
                        %table.line1
                          - q.items.each_with_index do |item, index|
                            %tr
                              %td
                                %label= d2c(index) + ". "
                                %span.item-content= item.render_question(q.image_path).html_safe
                  - if q.answer_content.present? || q.answer.present?
                    .question-answer
                      %strong.answer-label 解答:
                      - if q.answer.present?
                        %span= d2c(q.answer)
                    .question-answer-content
                      = render :partial => "partials/question_content", locals: { content: q.answer_content, image_path: q.image_path }